<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//projects.g-node.org/assets/gnode-bootstrap-theme/1.1.0-snapshot/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="//projects.g-node.org/assets/gnode-bootstrap-theme/1.0.0-snapshot/img/favicon.png">
    <title>G-Node GIN-Doi</title>
</head>
<body>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="//projects.g-node.org/assets/gnode-bootstrap-theme/1.0.0-snapshot/js/bootstrap.min.js"></script>
<div id="main">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                <a href="https://web.gin.g-node.org/" class="navbar-brand-gin"></a>
            </div>
            </div>
        </nav>
        <div class="container main-container">
                <h1>Welcome to the <strong>GIN</strong> (<strong>G</strong>-Node <strong>IN</strong>frastructure) DOI service!</h1>
                <hr>
            {{if .DoiInfo.Title}}
            <div class="alert alert-success" id="info">
                <div>
                    <b>Well Done! </b> Your repository "{{.DoiInfo.Title}}" fullfills all neccessarry requirements! Hit the button below to start the doification.
                </div>
            </div>
            <div class="jumbotron" id="infotable">
                <div id="infobox">The follwoing information will be registerd with you DOI request.
                    They will also be presented alongside the data. Please check them thoroughly and modify you cloudberry file if something is wrong.
                </div>
            <hr>
            <table class="table table-condensed">
                <tbody>
                <tr>
                    <td>Title</td>
                    <td>{{.DoiInfo.Title}}</td>
                </tr>
                <tr>
                    <td>Authors</td>
                    <td>
                        {{range $index, $auth := .DoiInfo.Authors}}
                        {{ $auth }}
                        <br>
                        {{end}}
                    </td>
                </tr>
                {{if .DoiInfo.Description}}
                <tr>
                    <td>Description</td>
                    <td>{{.DoiInfo.Description}}
                    </td>
                </tr>
                {{end}}
                {{if .DoiInfo.License}}
                <tr>
                    <td>License</td>
                    <td>{{.DoiInfo.License.Name}} ({{.DoiInfo.License.Url}})
                    </td>
                </tr>
                {{end}}
                <tr>
                    <td>References</td>
                    <td>
                        {{range $index, $ref := .DoiInfo.References}}
                        {{ $ref.Name }} [{{ $ref.Doi }}] ({{ $ref.Reftype }})
                        <br>
                        {{end}}
                    </td>
                </tr>
                <tr>
                    <td>Funding</td>
                    <td>
                        {{range $index, $ref := .DoiInfo.Funding}}
                        {{ $ref}}
                        <br>
                        {{end}}
                    </td>
                </tr>
                {{if .DoiInfo.Keywords}}
                <tr>
                    <td>Keywords</td>
                    <td>
                        {{range $index, $sub := .DoiInfo.Keywords}}
                        {{ $sub }}
                        <br>
                        {{end}}
                    </td>
                </tr>
                {{end}}
                </tbody>
            </table>
            </div>
            <div class="alert alert-danger" id="warnung">
                <div>
                    <b>Please be aware that all data in your repository will be part of the archived file that will be used for the DOI registration.</b>
                    (Yes, that really means ALL data - including private files, ssh keys, address books, password collections and whatnot.
                    If it happens to be in the repository, it will be in the archive).
                </div>
            </div>
            <div class="btn btn-primary" role="button" id="doify">Doify Now</div>
            {{else}}
            <div class="alert alert-warning">
                <div><b>This did not work. The Server seems to be angry with you and wont doify this request!</b> {{.Mess}}</div>
            </div>
            {{end}}
        </div>
        <nav class="navbar navbar-fixed-bottom navbar-default">
            <div class="container">
                <div class="row display-table">
                    <div class="col-sm-1 display-cell">
                        <a href="http://www.g-node.org" class="navbar-footer-brand-gin"></a>
                    </div>
                    <div class="col-sm-6 display-cell">
                        <ul class="list-inline">
                            <li>Â© G-Node, 2016-2017</li>
                            <li><a href="http://www.g-node.org/gin_terms">Terms of usage</a></li>
                        </ul>
                    </div> <div class="col-sm-6 display-cell">
                    <ul class="list-inline pull-right">
                        <li><a href="https://web.gin.g-node.org/info/about" class="">About</a></li>
                        <li><a href="https://web.gin.g-node.org/info/imprint" class="">Imprint</a></li>
                        <li><a href="https://web.gin.g-node.org/info/contact" class="">Contact</a></li>
                    </ul>
                </div>
                </div>
            </div>
        </nav>
</div>
<script>
    $(document).ready(function() {
        $ = jQuery.noConflict();
        $.ajaxSetup({cache: false});
        $("#main").on('click', "#doify", doify);
    });
    function doify(event) {
        $(event.target).addClass("disabled");
        $.ajax({
            url:"/do/",
            type:"POST",
            contentType: "text/plain",
            data:"{\"GinAuthUname\":\"{{.GinAuthUname}}\",\"URI\":\"{{  .URI}}\",\"token\":\"{{.Token}}\"}",
            dataType:"text",
            success: function (data) {
                $("#info").html(data);
                $("#info").toggleClass("alert-success");
                $("#info").toggleClass("alert-info");
                $("#infotable").hide();
                $("#warnung").hide();
            }
        });
    };
</script>
</body>
</html>
